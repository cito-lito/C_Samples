
## Interact with a ps2 mouse:

In order to provide more data to a Robot named "ITSE", get the data from the sensor
of a ps2 optical mouse:

#### Zephyr OS

This project is built using the Zephyr Operating System.
You can find [here](https://docs.zephyrproject.org/latest/application/index.html#application) a basic overview of how to build an Application using this OS.
 
#### Arduino:
For the determination of the X-Y position, we used a PS/2 optical mouse. Thanks to the "Computer Mouse Project" from [hofaciens.de](https://homofaciens.de/technics-base-circuits-computer-mouse_en.htm).We were able to read the X-Y positions of the mouse using an Arduino UNO:
![image](https://user-images.githubusercontent.com/41654186/170054437-9c32d6ab-2cf0-4b8d-ba5e-35558bc9339c.png)


 
#### Basic overview of the PS/2 protocol of a mouse
The PS2 mouse uses bidirectional synchronous serial communication. Where both lines(Data and Clock) are open-collector. If nothing is done they are in “idle” state/high impedance(two external or internal pull-up resistors pull the lines to a high state).
The Clock signal is always generated by the Mouse device. In order to get Clock signals, the Host(Micro-controller) needs to put the bus lines in “request to send” mode: Put the Clock bus to low signal, wait for at least 100us, put the Data bus low, and release the Clock. Now commands can be sent to the mouse.
There is a command set that may be sent to the mouse or that the mouse may send to the Host. For example, for this implementation the following commands were used:
Reset Mode 0xFF: set default values.
Remote Mode 0xF0: mouse sends data only when the
Read Data 0xEB command is received.
 
#### Host to Mouse Communication
 ![image](https://user-images.githubusercontent.com/41654186/170054835-9ecc9c18-837b-4ca7-9dee-e08aae0b81df.png)


Data is sent in a 12-bit frame:
-start bit
-data byte: For example the reset command.
-Parity bit
-stop bit
-acknowledgment bit
 
#### Mouse to Host Communication
 ![image](https://user-images.githubusercontent.com/41654186/170054874-6c322b42-3457-4fea-92a4-cdfe244841ba.png)


Data is sent in a 11-bit frame:
-start bit
-data byte: For example data byte with the X or Y position.
-Parity bit
-stop bit
 
### Implementation using the "feather_board"
For the implementation using the feather board, some problems popped up:
-Voltage of the nRF52 is 3.3v, the mouse is 5v.
-The Data and Clock signals from the mouse are both open-collector. Zephyr OS does not support open collector configuration at this moment.
 
#### To solve this, two additional modules were added:
-Level Conversion Module 5-3v System.
![image](https://user-images.githubusercontent.com/41654186/170054931-08985f28-102d-48c0-af51-fe6d736be801.png)

-SN74LS07 IC with Open-Collector output. [74LS07_Datasheet](https://wwwvs.cs.hs-rm.de/vs-wiki/index.php/Datei:74LS07.pdf)
![image](https://user-images.githubusercontent.com/41654186/170055063-33ffbd71-1428-452f-b579-479ce38c315d.png)
![image](https://user-images.githubusercontent.com/41654186/170055081-39429227-4e5f-42fb-9f77-cdd2d1fe47ad.png)



